# WebsocketParser

**WebsocketParser** ‚Äî —ç—Ç–æ C++ —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ —Ä–∞–∑–±–æ—Ä–∞ WebSocket —Ç—Ä–∞—Ñ–∏–∫–∞ –∏–∑ PCAP-—Ñ–∞–π–ª–æ–≤ (–¥–∞–º–ø–æ–≤ —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞).

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫—É [PcapPlusPlus](https://pcapplusplus.github.io/) –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è TCP-—Å–µ—Å—Å–∏–π, –∞ —Ç–∞–∫–∂–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É [fmt](https://github.com/fmtlib/fmt) –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–≤–æ–¥–∞.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ß—Ç–µ–Ω–∏–µ PCAP/PCAPNG**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á—Ç–µ–Ω–∏—è –¥–∞–º–ø–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–∞—Ö `.pcap` –∏ `.pcapng`.
- **TCP Reassembly**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞ TCP-—Å–µ–≥–º–µ–Ω—Ç–æ–≤ –≤ –µ–¥–∏–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö (TCP Reassembly), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã.
- **–ü–∞—Ä—Å–∏–Ω–≥ WebSocket**:
  - –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ WebSocket —Ñ—Ä–µ–π–º–æ–≤ (FIN, Opcode, Mask, Length).
  - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ–ø–∫–æ–¥–æ–≤ (Text, Binary, Close, Ping, Pong).
  - –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Client -> Server).
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π –¥–ª–∏–Ω—ã payload (16-bit –∏ 64-bit).
- **–°–µ—Å—Å–∏–∏**: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ TCP-—Å–µ—Å—Å–∏—è–º. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ç–æ–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏.
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—ã–≤–æ–¥ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–∞–∂–¥–æ–º —Ñ—Ä–µ–π–º–µ, –≤–∫–ª—é—á–∞—è –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π payload.

## ‚öôÔ∏è –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

### WebSocket –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (ws://)
–ü—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å **–Ω–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º** WebSocket-—Ç—Ä–∞—Ñ–∏–∫–æ–º. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Secure WebSocket (wss://), –≥–¥–µ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ TLS-—Ç—É–Ω–Ω–µ–ª—è, –æ–±—ã—á–Ω—ã–π WebSocket (ws://) –ø–µ—Ä–µ–¥–∞–µ—Ç —Ñ—Ä–µ–π–º—ã –ø—Ä—è–º–æ –ø–æ–≤–µ—Ä—Ö TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ HTTP Handshake. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞–π—Ç—ã –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∏ payload –Ω–∞–ø—Ä—è–º—É—é –∏–∑ —Å–µ—Ç–µ–≤–æ–≥–æ –¥–∞–º–ø–∞, –Ω–µ —Ç—Ä–µ–±—É—è –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞.

### üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ—Ä–µ–π–º–∞ WebSocket (RFC 6455)

–ü—Ä–æ—Ç–æ–∫–æ–ª WebSocket –ø–µ—Ä–µ–¥–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ñ—Ä–µ–π–º–æ–≤. –ö–∞–∂–¥—ã–π —Ñ—Ä–µ–π–º —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏ –ø–æ–ª–µ–∑–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∞ —Å—Ö–µ–º–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ—Ä–µ–π–º–∞ –≤ –±–∏—Ç–æ–≤–æ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–∏:

```text
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-------+-+-------------+-------------------------------+
     |F|R|R|R| opcode|M| Payload len |    Extended payload length    |
     |I|S|S|S|  (4)  |A|     (7)     |             (16/64)           |
     |N|V|V|V|       |S|             |   (if payload len==126/127)   |
     | |1|2|3|       |K|             |                               |
     +-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - +
     |     Extended payload length continued, if payload len == 127  |
     + - - - - - - - - - - - - - - - +-------------------------------+
     |                               |Masking-key, if MASK set to 1  |
     +-------------------------------+-------------------------------+
     | Masking-key (continued)       |          Payload Data         |
     +-------------------------------- - - - - - - - - - - - - - - - +
     :                     Payload Data continued ...                :
     + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +
     |                     Payload Data continued ...                |
     +---------------------------------------------------------------+
```

#### –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –ø–æ–ª–µ–π:

*   **FIN (1 –±–∏—Ç):** –§–ª–∞–≥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è. –£–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ —ç—Ç–æ—Ç —Ñ—Ä–µ–π–º —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–º —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–º —Å–æ–æ–±—â–µ–Ω–∏—è.
*   **RSV1, RSV2, RSV3 (–ø–æ 1 –±–∏—Ç—É):** –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω—ã –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π. –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–≤–Ω—ã 0, –µ—Å–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.
*   **Opcode (4 –±–∏—Ç–∞):** –¢–∏–ø –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–æ–ø–µ—Ä–∞—Ü–∏—è):
    *   `0x1`: –¢–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (Text)
    *   `0x2`: –ë–∏–Ω–∞—Ä–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (Binary)
    *   `0x8`: –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (Close)
    *   `0x9`: Ping
    *   `0xA`: Pong
*   **MASK (1 –±–∏—Ç):** –§–ª–∞–≥ –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏. –ï—Å–ª–∏ —Ä–∞–≤–µ–Ω 1, —Ç–æ –¥–∞–Ω–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã XOR-–º–∞—Å–∫–æ–π. –ö–ª–∏–µ–Ω—Ç **–≤—Å–µ–≥–¥–∞** –¥–æ–ª–∂–µ–Ω –º–∞—Å–∫–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ.
*   **Payload Length (7 –±–∏—Ç):** –î–ª–∏–Ω–∞ –¥–∞–Ω–Ω—ã—Ö.
    *   `0-125`: –§–∞–∫—Ç–∏—á–µ—Å–∫–∞—è –¥–ª–∏–Ω–∞ payload.
    *   `126`: –°–ª–µ–¥—É—é—â–∏–µ 2 –±–∞–π—Ç–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç 16-–±–∏—Ç–Ω—É—é –¥–ª–∏–Ω—É (–¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –¥–æ 64 –ö–ë).
    *   `127`: –°–ª–µ–¥—É—é—â–∏–µ 8 –±–∞–π—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç 64-–±–∏—Ç–Ω—É—é –¥–ª–∏–Ω—É (–¥–ª—è –±–æ–ª—å—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π).
*   **Masking-Key (32 –±–∏—Ç–∞):** –ö–ª—é—á –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏. –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `MASK = 1`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è payload.
*   **Payload Data:** –ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ (–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è).

### –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–∑–±–æ—Ä–∞ —Å–µ—Å—Å–∏–∏

–ü—Ä–æ—Ü–µ—Å—Å –∞–Ω–∞–ª–∏–∑–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1.  **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ TCP-–ø–æ—Ç–æ–∫–∞ (TCP Reassembly)**
    –°–µ—Ç–µ–≤—ã–µ –ø–∞–∫–µ—Ç—ã –≤ PCAP-—Ñ–∞–π–ª–µ –º–æ–≥—É—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –Ω–µ –ø–æ –ø–æ—Ä—è–¥–∫—É, –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏–ª–∏ –±—ã—Ç—å —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ (–∫–æ–≥–¥–∞ –æ–¥–∏–Ω WebSocket —Ñ—Ä–µ–π–º —Ä–∞–∑–±–∏—Ç –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ TCP –ø–∞–∫–µ—Ç–æ–≤).
    –Ø –∏—Å–ø–æ–ª—å–∑—É—é `pcapplusplus::TcpReassembly`, –∫–æ—Ç–æ—Ä—ã–π:
    *   –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å TCP-—Å–µ–≥–º–µ–Ω—Ç–æ–≤ (sequence numbers).
    *   –°–æ–±–∏—Ä–∞–µ—Ç —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ.
    *   –ü–µ—Ä–µ–¥–∞–µ—Ç —Å–æ–±—Ä–∞–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ –±–∞–π—Ç–æ–≤ –≤ callback-—Ñ—É–Ω–∫—Ü–∏—é `onTcpMessageReady`.

2.  **–ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –ø–æ—Ç–æ–∫–∞**
    –ì—Ä–∞–Ω–∏—Ü—ã TCP-–ø–∞–∫–µ—Ç–æ–≤ —Ä–µ–¥–∫–æ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –≥—Ä–∞–Ω–∏—Ü–∞–º–∏ WebSocket-—Ñ—Ä–µ–π–º–æ–≤.
    *   –í—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ –±—É—Ñ–µ—Ä —Å–µ—Å—Å–∏–∏ (`std::vector<uint8_t> buffer`).
    *   –ü–∞—Ä—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ü–∏–∫–ª–µ, –ø—ã—Ç–∞—è—Å—å –∏–∑–≤–ª–µ—á—å –ø–æ–ª–Ω—ã–µ —Ñ—Ä–µ–π–º—ã –∏–∑ –Ω–∞—á–∞–ª–∞ –±—É—Ñ–µ—Ä–∞.
    *   –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –±—É—Ñ–µ—Ä–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∏–ª–∏ —Ç–µ–ª–∞ —Ñ—Ä–µ–π–º–∞, –ø–∞—Ä—Å–∏–Ω–≥ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∂–¥–µ—Ç —Å–ª–µ–¥—É—é—â–∏—Ö –ø–∞–∫–µ—Ç–æ–≤.

3.  **–ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ—Ä–µ–π–º–∞**
    –ö–∞–∂–¥—ã–π —Ñ—Ä–µ–π–º —Ä–∞–∑–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ–±–∏—Ç–æ–≤–æ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å–æ —Å—Ö–µ–º–æ–π –≤—ã—à–µ: —Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ñ–ª–∞–≥–∏, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è –¥–ª–∏–Ω–∞ (—Å —É—á–µ—Ç–æ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π) –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –º–∞—Å–∫–∞.

4.  **–î–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ (Unmasking)**
    –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω—ã, payload —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–µ–π XOR:
    ```cpp
    decoded_byte[i] = encoded_byte[i] ^ masking_key[i % 4]
    ```

5.  **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ Payload**
    –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è, –∏ —É–∫–∞–∑–∞—Ç–µ–ª—å –≤ –±—É—Ñ–µ—Ä–µ —Å–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ –¥–ª–∏–Ω—É –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ —Ñ—Ä–µ–π–º–∞. Payload —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª —Å–µ—Å—Å–∏–∏, –∞ —Ü–∏–∫–ª –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –±—É—Ñ–µ—Ä–µ.

## üõ† –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–î–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ –≤–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è:

- **C++ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π C++17 (MSVC, GCC, Clang).
- **CMake** (–≤–µ—Ä—Å–∏—è 3.10 –∏–ª–∏ –≤—ã—à–µ).
- **vcpkg** ‚Äî –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ –¥–ª—è C++.

## üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ vcpkg):
- `pcapplusplus`: –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ç–µ–≤—ã–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏.
- `fmt`: –î–ª—è —É–¥–æ–±–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫.

*–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –¥–ª—è Windows:* –î–ª—è —Ä–∞–±–æ—Ç—ã PcapPlusPlus —Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä **Npcap** (–≤ —Ä–µ–∂–∏–º–µ WinPcap compatibility) –∏–ª–∏ **WinPcap**.

## üî® –°–±–æ—Ä–∫–∞

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
   ```bash
   git clone <url-to-repo>
   cd websocket_parser
   ```

2. **–°–±–æ—Ä–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CMake –∏ vcpkg:**

   –ï—Å–ª–∏ —É –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è vcpkg —Å CMake:
   ```bash
   mkdir build
   cd build
   cmake ..
   cmake --build .
   ```

   –ò–ª–∏ —É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ toolchain-—Ñ–∞–π–ª—É vcpkg —è–≤–Ω–æ:
   ```bash
   cmake -B build -S . -DCMAKE_TOOLCHAIN_FILE=[–ø—É—Ç—å/–∫/vcpkg]/scripts/buildsystems/vcpkg.cmake
   cmake --build build
   ```

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ `capture/capture2.htm` (–ø—É—Ç—å –∑–∞–¥–∞–Ω –≤ `main.cpp`). 

1. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª–∞ –¥–∞–º–ø–∞:**
   –ü–æ–º–µ—Å—Ç–∏—Ç–µ –≤–∞—à pcap-—Ñ–∞–π–ª –≤ –ø–∞–ø–∫—É `capture/` –∏–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø—É—Ç—å –≤ —Ñ–∞–π–ª–µ `main.cpp` (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `pcapFileName`) –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç.

2. **–ó–∞–ø—É—Å–∫:**
   ```bash
   ./build/Debug/WebsocketParser.exe
   ```

3. **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
   –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ñ–∞–π–ª –∏ —Å–æ–∑–¥–∞—Å—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è –∫–∞–∂–¥–æ–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–π WebSocket-—Å–µ—Å—Å–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
   `websocket_session_[SRC_IP]_[SRC_PORT]_[DST_IP]_[DST_PORT]_[FLOW_ID].txt`

   –í–Ω—É—Ç—Ä–∏ —Ñ–∞–π–ª–æ–≤ –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:
   ```text
   --- WebSocket Frame ---
   Time: 2023-10-27 10:00:01.123456 UTC
   FIN: true, Opcode: 1, Masked: true, Length: 45
   <Payload data here...>
   ```

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- `main.cpp`: –û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (–ø–∞—Ä—Å–∏–Ω–≥, TCP reassembly, –ª–æ–≥–∏–∫–∞ WebSocket).
- `CMakeLists.txt`: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±–æ—Ä–∫–∏ CMake.
- `vcpkg.json`: –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø—Ä–æ–µ–∫—Ç–∞.
- `capture/`: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ñ–∞–π–ª–æ–≤ –¥–∞–º–ø–æ–≤ —Ç—Ä–∞—Ñ–∏–∫–∞.

## ü§ù –í–∫–ª–∞–¥ –≤ —Ä–∞–∑–≤–∏—Ç–∏–µ (Contributing)

–ë—É–¥—É —Ä–∞–¥ –ª—é–±—ã–º —É–ª—É—á—à–µ–Ω–∏—è–º! –ü—Ä–∏—Å—ã–ª–∞–π—Ç–µ Pull Requests –∏–ª–∏ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ Issues, –µ—Å–ª–∏ –Ω–∞—à–ª–∏ –æ—à–∏–±–∫—É.
